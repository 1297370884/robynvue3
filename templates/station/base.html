<!DOCTYPE html>
<html lang="zxx">
   <head>
      <title>Toys Shop an Ecommerce Category Bootstrap Responsive Web Template </title>
      <!--meta tags -->
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="keywords" content="Toys Shop Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template,
         Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design">
      <script>
         addEventListener("load", function () {
         	setTimeout(hideURLbar, 0);
         }, false);

         function hideURLbar() {
         	window.scrollTo(0, 1);
         }
      </script>
      <!--//meta tags ends here-->
      <!--booststrap-->
      <link href="/static/index/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all">
      <!--//booststrap end-->
      <!-- font-awesome icons -->
      <link href="/static/index/css/fontawesome-all.min.css" rel="stylesheet" type="text/css" media="all">
      <!-- //font-awesome icons -->
      <!-- For Clients slider -->
      {% block css %}
      {% endblock css %}
      <!--flexs slider-->
      <!--Shoping cart-->
      <link rel="stylesheet" href="/static/index/css/shop.css" type="text/css">
      <!--//Shoping cart-->
      <!--stylesheets-->
      <link href="/static/index/css/style.css" rel='stylesheet' type='text/css' media="all">
      <!--//stylesheets-->



   </head>
   <body>
      <div class="header-outs" id="home">
         <div class="header-bar">
            <div class="info-top-grid">
               <div class="info-contact-agile">
                  <ul>
                     <li>
                        <span class="fas fa-phone-volume"></span>
                        <p>+(000)123 4565 32</p>
                     </li>
                     <li>
                        <span class="fas fa-envelope"></span>
                        <p><a href="mailto:info@example.com">info@example1.com</a></p>
                     </li>
                     <li>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="container-fluid">
               <div class="hedder-up row">
                   {% block hedder1 %}
                   {% endblock hedder1 %}
                   <div class="col-lg-3 col-md-3 logo-head">
                    <h1><a class="navbar-brand" href="">Toys-Shop</a></h1>
                 </div>
                 <div class="col-lg-5 col-md-6 search-right">
                    <form class="form-inline my-lg-0">
                       <input class="form-control mr-sm-2" type="search" placeholder="Search">
                       <button class="btn" type="submit">Search</button>
                    </form>
                 </div>
                 <div class="col-lg-4 col-md-3 right-side-cart">
                    <div class="cart-icons">
                       <ul>
                          <li>
                             <span class="far fa-heart"></span>
                          </li>
                          <li>
                             <button type="button" data-toggle="modal" data-target="#exampleModal"> <span class="far fa-user"></span></button>
                          </li>
                          <li class="toyscart toyscart2 cart cart box_1">
                             <form action="#" method="post" class="last">
                                <input type="hidden" name="cmd" value="_cart">
                                <input type="hidden" name="display" value="1">
                                <button class="top_toys_cart" type="submit" name="submit" value="">
                                <span class="fas fa-cart-arrow-down"></span>
                                </button>
                             </form>
                          </li>
                       </ul>
                    </div>
                 </div>
              </div>
           </div>
           <nav class="navbar navbar-expand-lg navbar-light">
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse justify-content-center" id="navbarSupportedContent">
                 <ul class="navbar-nav ">
                      {% block li1 %}
                      {% endblock li1 %}
                  </ul>
               </div>
            </nav>
         </div>
         {% block slider %}
         {% endblock slider %}
      </div>
         {% block section %}
        {% endblock section %}
      <section class="sub-below-address py-lg-4 py-md-3 py-sm-3 py-3">
        <div class="container py-lg-5 py-md-5 py-sm-4 py-3">
            <h3 class="title clr text-center mb-lg-5 mb-md-4 mb-sm-4 mb-3">Get In Touch Us</h3>
            <div class="icons mt-4 text-center">
              <ul>
                  <li><a href="#"><span class="fab fa-facebook-f"></span></a></li>
                  <li><a href="#"><span class="fas fa-envelope"></span></a></li>
                  <li><a href="#"><span class="fas fa-rss"></span></a></li>
                  <li><a href="#"><span class="fab fa-vk"></span></a></li>
              </ul>
              <p class="my-3">velit sagittis vehicula. Duis posuere
                  ex in mollis iaculis. Suspendisse tincidunt
                  velit sagittis vehicula. Duis posuere
                  velit sagittis vehicula. Duis posuere
              </p>
            </div>
            <div class="email-sub-agile">
              <form action="#" method="post">
                  <div class="form-group sub-info-mail">
                    <input type="email" class="form-control email-sub-agile" placeholder="Email">
                  </div>
                  <div class="text-center">
                    <button type="submit" class="btn subscrib-btnn">Subscribe</button>
                  </div>
              </form>
            </div>
        </div>
      </section>
      <!--//subscribe-->
      <!-- footer -->
      <footer class="py-lg-4 py-md-3 py-sm-3 py-3 text-center">
         <div class="copy-agile-right">
            <p>
               Copyright &copy; 2022.Company name All rights reserved.<a target="_blank" href="https://sc.chinaz.com/moban/">&#x7F51;&#x9875;&#x6A21;&#x677F;</a>
            </p>
         </div>
      </footer>
      <!-- //footer -->
      <!-- Modal 1-->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
           <div class="modal-content">
              <div class="modal-header">
                 <h5 class="modal-title" id="exampleModalLabel">Login</h5>
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                 <span aria-hidden="true">&times;</span>
                 </button>
              </div>
              <div class="modal-body">
                 <!-- 登陆界面 -->
                  <div class="register-form" id="login-form" method="post">
                     <div class="fields-grid">
                       <div class="styled-input">
                         <input type="text" id="identifier" name="identifier" class="form-control" placeholder="Email or phone" aria-label="Email or phone" autocomplete="username" autocapitalize="none" spellcheck="false" required/>
                         <div class="error-message" aria-live="polite"></div>
                        </div>
                         <!--<div class="error-message" aria-live="polite"></div> -->
                       <div class="styled-input">
                         <!-- 输入密码 -->
                           <input type="password" id="password" name="password" class="form-control" placeholder="Password" aria-label="Password" autocomplete="current-password" required/>
                           <div class="error-message" aria-live="polite"></div>
                       </div>

                       <button type="submit" id="submit-btn" class="btn subscrib-btnn">Login</button>
                       <a type="button" id="switch-to-register">Create an account</a>
                     </div>
                  </div>

                 <!-- 注册界面 -->
                 <div class="register-form" id="register-form" style="display: none;" method="post">
                     <div class="fields-grid">
                       <div class="styled-input">
                         <input type="text" placeholder="Your Name" name="user_name" id="user_name" required="">
                         <div class="error-message" aria-live="polite"></div></div>
                       <div class="styled-input">
                         <input type="email" placeholder="Your Email" name="email" id="email"  required="">
                         <div class="error-message" aria-live="polite"></div></div>
                       <div class="styled-input">
                         <input type="text" placeholder="Your Phone Number" name="phonenumber" id="phonenumber" required="">
                         <div class="error-message" aria-live="polite"></div></div>
                       <div class="styled-input">
                         <input type="password" placeholder="Password" name="password" id="register_password" required="">
                         <div class="error-message" aria-live="polite"></div></div>
                       <div class="styled-input">
                         <input type="password" placeholder="Confirm Password" name="confirm_password" id="confirm_password" required="">
                         <div class="error-message" aria-live="polite"></div></div>
                       <button type="submit" class="login-btn" id="register-button">Register</button>
                       <button type="button" id="switch-to-login" class="btn subscrib-btnn">Back to Login</button>
                     </div>
                 </div>
                 <!-- 邮箱验证界面 -->
                  <div class="register-form" id="email-form" style="display: none;" method="post">
                    <div class="fields-grid">
                       <div class="styled-input">
                         <input type="text" placeholder="Input Verify" name="verify" id="register_verify" required>
                         <div class="error-message" aria-live="polite"></div>
                       </div>
                       <button type="submit" class="login-btn" id="verify-button">Verify</button>
                       <button type="submit" class="send-button" id="send-button">Resend</button>
                       <button type="button" id="back-to-register" class="btn subscrib-btnn">Back to Register</button>
                     </div>
                 </div>
              </div>
              <div class="modal-footer">
                 <button type="button" class="btn btn-secondary" id = "close-all", data-dismiss="modal">Close</button>
              </div>
           </div>
        </div>
     </div>
      <!-- //Modal 1-->
      <!--js working-->
        <script src='/static/index/js/jquery-2.2.3.min.js'></script>
        <script>
          // 验证规则
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          const phoneRegex = /^1[3-9]\d{9}$/;

          // 获取输入字段和错误提示
          const identifierField = document.getElementById('identifier');
          const passwordField = document.getElementById('password');
          const identifierError = identifierField.nextElementSibling;
          const passwordError = passwordField.nextElementSibling;

          // 标志变量：标识用户是否点击过登录按钮
          let hasSubmitted = false;

          // 定义验证函数
          function validateFields() {
            const identifierValue = identifierField.value.trim();
            const passwordValue = passwordField.value.trim();

            // 初始化验证状态
            let isValid = true;

            // 如果未点击登录按钮，则不显示提示信息
            if (!hasSubmitted) {
              identifierError.style.display = 'none';
              passwordError.style.display = 'none';
              return isValid;
            }

            // 验证电子邮件或手机号
            if (!identifierValue) {
              identifierField.classList.add('error');
              identifierError.textContent = '电子邮件地址或手机号不能为空';
              identifierError.style.display = 'block';
              isValid = false;
            } else if (!emailRegex.test(identifierValue) && !phoneRegex.test(identifierValue)) {
              identifierField.classList.add('error');
              identifierError.textContent = '请输入有效的电子邮件地址或手机号';
              identifierError.style.display = 'block';
              isValid = false;
            } else {
              identifierField.classList.remove('error');
              identifierError.textContent = '';
              identifierError.style.display = 'none';
            }

            // 验证密码
            if (!passwordValue) {
              passwordField.classList.add('error');
              passwordError.textContent = '密码不能为空';
              passwordError.style.display = 'block';
              isValid = false;
            } else if (passwordValue.length < 6) {
              passwordField.classList.add('error');
              passwordError.textContent = '密码长度不能小于6位';
              passwordError.style.display = 'block';
              isValid = false;
            } else {
              passwordField.classList.remove('error');
              passwordError.textContent = '';
              passwordError.style.display = 'none';
            }

            return isValid;
          }

          // 添加鼠标点击事件监听器
          window.addEventListener('click', validateFields);

          function handleLogin(){
                            // 设置标志变量为 true
            hasSubmitted = true;

            // 验证字段
            if (validateFields()) {
              // 如果验证未通过（存在错误或未输入），不向后端发送数据   
              const hasError = identifierError.textContent !== '' || passwordError.textContent !== '' || identifierField.value.trim() === '' || passwordField.value.trim() === '';
              if (hasError) {
                  console.warn("存在验证错误，阻止请求发送！");
                  return;
              }

              // 如果验证通过，向后端发送数据
              const identifier = identifierField.value.trim();
              const password = passwordField.value.trim();
              console.log("identifier:", identifier);
              console.log("password:", password);

              // 发送登录请求
              $.ajax({
                url: "/users/login",  
                type: 'post',
                contentType: 'application/json',
                data: JSON.stringify({
                  'account': identifier,
                  'password': password
                }),
                success: function (response) {
                  console.log("成功回调：", response);
                  // 直接检查 response 中是否包含 message
                  if (response.message === "登录成功") {
                    console.log("登录成功");
                    alert(response.message);
                    
                    // 可以保存 token 到 localStorage
                    if (response.token) {
                      localStorage.setItem('token', response.token);
                    }
                    
                    setTimeout(function () {
                      window.location.href = "";
                    }, 600);
                  } else {
                    alert(response.message || "登录失败");
                    console.error("登录失败，返回数据：", response);
                  }
                },
                error: function(xhr, status, error) {
                  console.error("请求失败：", status, error);
                  alert("登录失败，请稍后重试");
                }
              });
            }

          }

          // 点击登录按钮事件
          document.getElementById('submit-btn').addEventListener('click', handleLogin);

          // 按下回车键触发登录事件
          document.addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
              handleLogin();
            }
          });


      </script>
      <script>
       $('.imgcode').hover(function(){
            layer.tips("Can't see clearly? change one", '.verify', {
                time: 6000,
                tips: [2, "#3c3c3c"]
            })
        },function(){
            layer.closeAll('tips');
        }).click(function(){
            $(this).attr('src', 'url' + Math.random());
        });
      </script>
    <script>
        // 定义显示加载对话框的函数
          function showLoadingDialog() {
            const loadingDialog = document.createElement('div');
            loadingDialog.id = 'loading-dialog';
            loadingDialog.style.position = 'fixed';
            loadingDialog.style.top = '0';
            loadingDialog.style.left = '0';
            loadingDialog.style.width = '100%';
            loadingDialog.style.height = '100%';
            loadingDialog.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
            loadingDialog.style.display = 'flex';
            loadingDialog.style.justifyContent = 'center';
            loadingDialog.style.alignItems = 'center';
            loadingDialog.style.zIndex = '9999';
            loadingDialog.innerHTML = `
              <div style="background: white; padding: 20px; border-radius: 5px; text-align: center;">
                <p>发送中，请稍候...</p>
                <div class="spinner" style="margin-top: 10px; width: 30px; height: 30px; border: 4px solid rgba(0, 0, 0, 0.2); border-top-color: black; border-radius: 50%; animation: spin 1s linear infinite;"></div>
              </div>
            `;

            // 添加 CSS 动画
            const style = document.createElement('style');
            style.textContent = `
              @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
              }
            `;
            document.head.appendChild(style);

            document.body.appendChild(loadingDialog);
          }

          // 定义关闭加载对话框的函数
          function closeLoadingDialog() {
            const loadingDialog = document.getElementById('loading-dialog');
            if (loadingDialog) {
              loadingDialog.remove();
            }
          }
    </script>
    <script>

        const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/;

        // 获取输入字段和错误提示
        const usernameField = document.getElementById('user_name');
        const emailField = document.getElementById('email');
        const phoneField = document.getElementById('phonenumber');
        const password1Field = document.getElementById('register_password');
        const password2Field = document.getElementById('confirm_password');
        const usernameError = usernameField.nextElementSibling;
        const emailError = emailField.nextElementSibling;
        const phoneError = phoneField.nextElementSibling;
        const password1Error = password1Field.nextElementSibling;
        const password2Error = password2Field.nextElementSibling;

        // 标志变量：标识用户是否点击过注册按钮
        let hasSubmitted2 = false;

        // 定义验证函数
        function validateFields() {
            const usernameValue = usernameField.value.trim();
            const emailValue = emailField.value.trim();
            const phoneValue = phoneField.value.trim();
            const password1Value = password1Field.value.trim();
            const password2Value = password2Field.value.trim();

            // 初始化验证状态
            let isValid = true;

            // 如果未点击注册按钮，则不显示提示信息
            if (!hasSubmitted2) {
              usernameError.style.display = 'none';
              emailError.style.display = 'none';
              phoneError.style.display = 'none';
              password1Error.style.display = 'none';
              password2Error.style.display = 'none';
              return isValid;
            }

            // 验证用户名
            if (!usernameValue) {
              usernameField.classList.add('error');
              usernameError.textContent = '用户名不能为空';
              usernameError.style.display = 'block';
              isValid = false;
            } else {
              usernameField.classList.remove('error');
              usernameError.textContent = '';
              usernameError.style.display = 'none';
            }

            // 验证邮箱
            if(!emailValue) {
              emailField.classList.add('error');
              emailError.textContent = '邮箱不能为空';
              emailError.style.display = 'block';
              isValid = false;
            } else if (!emailRegex.test(emailValue)){
              emailField.classList.add('error');
              emailError.textContent = '请输入有效的电子邮件地址';
              emailError.style.display = 'block';
              isValid = false;
            } else {
              emailField.classList.remove('error');
              emailError.textContent = '';
              emailError.style.display = 'none';
            }

            // 验证手机号
            if(!phoneValue) {
              phoneField.classList.add('error');
              phoneError.textContent = '手机号不能为空';
              phoneError.style.display = 'block';
              isValid = false;
            } else if (!phoneRegex.test(phoneValue)) {
              phoneField.classList.add('error');
              phoneError.textContent = '请输入有效的手机号码';
              phoneError.style.display = 'block';
              isValid = false;
            } else {
              phoneField.classList.remove('error');
              phoneError.textContent = '';
              phoneError.style.display = 'none';
            }

            // 定义验证密码的逻辑
            if (!password1Value) {
              password1Field.classList.add('error');
              password1Error.textContent = '密码不能为空';
              password1Error.style.display = 'block';
              isValid = false;
            } else if (password1Value.length < 6) {
              password1Field.classList.add('error');
              password1Error.textContent = '密码长度不能小于6位';
              password1Error.style.display = 'block';
              isValid = false;
            } else if (!passwordRegex.test(password1Value)) {
              password1Field.classList.add('error');
              password1Error.textContent = '密码必须包含数字和字母';
              password1Error.style.display = 'block';
              isValid = false;
            } else {
              password1Field.classList.remove('error');
              password1Error.textContent = '';
              password1Error.style.display = 'none';
            }

            // 重复输入密码
            if(!password2Value) {
              password2Field.classList.add('error');
              password2Error.textContent = '请再次输入密码';
              password2Error.style.display = 'block';
              isValid = false;
            } else if (password1Value != password2Value) {
              password2Field.classList.add('error');
              password2Error.textContent = '两次输入的密码不一致';
              password2Error.style.display = 'block';
              isValid = false;
            } else {
              password2Field.classList.remove('error');
              password2Error.textContent = '';
              password2Error.style.display = 'none';
            }

            return isValid;
          }

          // 添加鼠标点击事件监听器
          window.addEventListener('click', validateFields);

          document.getElementById('register-button').addEventListener('click', function () {
              const registerButton = document.getElementById('register-button');

              // 如果按钮已禁用，则直接返回，避免重复提交
              if (registerButton.disabled) {
                  console.warn("请误重复点击提交,请在5分钟内查看邮箱验证码...");
                  return;
              }

              // 设置标志变量为 true
              hasSubmitted2 = true;

              // 如果验证通过，向后端发送数据
              if (validateFields()) {
                  // 如果验证未通过，不向后端发送数据
                  const hasError =
                      usernameError.textContent !== '' ||
                      emailError.textContent !== '' ||
                      phoneError.textContent !== '' ||
                      password1Error.textContent !== '' ||
                      password2Error.textContent !== '';
                  if (hasError) {
                      console.warn("存在验证错误，阻止请求发送！");
                      return;
                  }

                  // 如果验证通过，向后端发送数据
                  // 收集注册表单数据
                   const registerData = {
                         username: usernameField.value.trim(),
                         email: emailField.value.trim(),
                         phonenumber: phoneField.value.trim(),
                         password: password1Field.value.trim()
                   };

                  // 禁用按钮，防止重复提交
                  registerButton.disabled = true;

                  // 启动一个计时器，60 秒后重新启用按钮
                  setTimeout(() => {
                      registerButton.disabled = false;
                  }, 60000);

                  // 发送注册请求
                  $.ajax({
                      url: "",
                      type: 'post',
                      data: registerData,
                        beforeSend: function () {
                          // 在请求发送前显示加载对话框
                          showLoadingDialog();
                        },
                      success: function (data) {
                          console.log("成功回调：", data); // 打印返回数据
                          alert(data.errmsg);
                          if (data.status === 3 || data.status === 2) {
                              console.log("跳转到邮箱验证页面");

                              // 获取模态框内容块
                              const registerForm = document.getElementById("register-form");
                              const verifyForm = document.getElementById("email-form")

                              // 切换界面
                              registerForm.style.display = "none";
                              verifyForm.style.display = "block";
                              hasSubmitted2 = false; // 重置提交标志

                              // 邮箱验证逻辑
                              setupEmailVerification(registerData);
                          }else {
                              console.error("操作失败，状态码：", data.status, "错误信息：", data.errmsg);
                          }
                      },
                      complete: function () {
                          // 无论成功或失败，解除按钮的禁用状态
                          registerButton.disabled = false;
                          // 在请求完成后无论成功与否都关闭加载对话框
                          closeLoadingDialog();
                      },
                        error: function (xhr, status, error) {
                          console.error("请求失败：", status, error);
                          alert("请求失败，请稍后重试！");
                        }
                  });
              }
          });



          // 邮箱验证逻辑
          function setupEmailVerification(registerData) {
                  const verifycodeField = document.getElementById('register_verify');
                  const verifycodeError = verifycodeField.nextElementSibling;
                  // 标志变量：标识用户是否点击过验证按钮
                  let hasSubmitted3 = false;

                  // 定义验证输入规范函数
                  function validateFields3() {
                        const verifyCode = verifycodeField.value.trim();

                        // 初始化验证状态
                        let isValid = true;

                        // 如果未点击验证按钮，则不显示提示信息
                        if (!hasSubmitted3) {
                          verifycodeError.style.display = 'none';
                          return isValid;
                        }

                        // 验证验证码
                        if (!verifyCode) {
                          verifycodeField.classList.add('error');
                          verifycodeError.textContent = '验证码不能为空';
                          verifycodeError.style.display = 'block';
                          isValid = false;
                        } else if (verifyCode.length != 6) {
                          verifycodeField.classList.add('error');
                          verifycodeError.textContent = '验证码输入不符合规范';
                          verifycodeError.style.display = 'block';
                          isValid = false;
                        }else {
                          verifycodeField.classList.remove('error');
                          verifycodeError.textContent = '';
                          verifycodeError.style.display = 'none';
                        }

                        return isValid;
                      }

                  // 添加鼠标点击事件监听器
                  window.addEventListener('click', validateFields3);


                  function handleVerify(){
                    // 设置标志变量为 true
                    hasSubmitted3 = true;

                    // 验证字段
                    if (validateFields3()) {
                      // 如果验证未通过，不向后端发送数据
                      const codehasError = verifycodeError.textContent !== '';
                      if (codehasError) {
                          console.warn("存在验证错误，阻止请求发送！");
                          return;
                      }

                      // 如果验证通过，向后端发送数据
                      const verifyCode = verifycodeField.value.trim();

                      // 合并验证码和注册数据
                      const verifyData = {
                         ...registerData,  // 展开注册数据
                         code: verifyCode  // 添加验证码
                      };

                      $.ajax({
                          url: "",
                          type: 'post',
                          data: verifyData,
                          success: function (data) {
                              console.log("邮箱验证成功回调:", data);
                              console.log("提交的数据:", verifyData);
                              alert(data.errmsg);
                              if (data.status === 5) {
                                  console.log("邮箱验证成功");
                                  setTimeout(function () {
                                      window.location.href = "";
                                  }, 600);
                              } else {
                                  console.error("邮箱验证失败，状态码：", data.status, "错误信息：", data.errmsg);
                              }
                          }
                      });
                    }

                  }

                  // 点击验证按钮事件
                  document.getElementById('verify-button').addEventListener('click', handleVerify);

                  // 按下回车键触发验证事件
                  document.addEventListener('keydown', function (event) {
                    if (event.key === 'Enter') {
                      validateFields3();
                      handleVerify();
                    }
                  });


          }


          // 发送邮箱验证码
          function sendEmailVerification(email) {
              document.getElementById('send-button').addEventListener('click', function () {
                  const sendButton = document.getElementById('send-button');

                  // 如果按钮已禁用，则直接返回，避免重复提交
                  if (sendButton.disabled) {
                      console.warn("请误重复点击提交,请在5分钟内查看邮箱验证码...");
                      return;
                  }

                  $.ajax({
                      url: "",
                      type: 'post',
                      data: {
                          'email': registerData.email
                      },
                      beforeSend: function () {
                          // 在请求发送前显示加载对话框
                          showLoadingDialog();
                        },
                      success: function (data) {
                          console.log("邮箱验证成功回调：", data);
                          alert(data.errmsg);
                          if (data.status === 3) {
                              console.log("邮箱发送成功");
                              // 禁用按钮，防止重复提交
                              sendButton.disabled = true;
                              // 启动一个计时器，5 分钟后重新启用按钮
                              setTimeout(() => {
                                  sendButton.disabled = false;
                              }, 300000);

                          } else {
                              console.error("邮箱发送失败，状态码：", data.status, "错误信息：", data.errmsg);
                          }
                      }
                  });
              });
          }


          document.getElementById('back-to-register').addEventListener('click', function () {
                  // 返回到注册表单
                  document.getElementById('email-form').style.display = 'none';
                  document.getElementById('register-form').style.display = 'block';
              });

    </script>

    <script>
      // 获取切换按钮
      // 定义通用清空输入框和错误提示的函数
      function clearErrorsAndInputs(fields, errors) {
        fields.forEach(field => {
          field.value = ""; // 清空输入框内容
          field.classList.remove("error"); // 移除错误样式
        });
        errors.forEach(error => {
          error.textContent = ""; // 清空错误提示内容
          error.style.display = "none"; // 隐藏错误提示
        });
      }

      // 登录和注册表单输入与错误集合
      const loginFields = [identifierField, passwordField];
      const loginErrors = [identifierError, passwordError];
      const registerFields = [usernameField, emailField, phoneField, password1Field, password2Field];
      const registerErrors = [usernameError, emailError, phoneError, password1Error, password2Error];

      // 获取切换按钮
      const switchToRegister = document.getElementById("switch-to-register");
      const switchToLogin = document.getElementById("switch-to-login");

      // 获取关闭按钮
      const closeButton = document.getElementById("close-all");

      // 获取模态框内容块
      const loginForm = document.getElementById("login-form");
      const registerForm = document.getElementById("register-form");

      // 添加事件监听器

      // 切换到注册界面
      switchToRegister.addEventListener("click", () => {
        clearErrorsAndInputs(loginFields, loginErrors); // 清空登录表单内容
        loginForm.style.display = "none";
        registerForm.style.display = "block";
        hasSubmitted = false; // 重置提交标志
      });

      // 切换到登录界面
      switchToLogin.addEventListener("click", () => {
        clearErrorsAndInputs(registerFields, registerErrors); // 清空注册表单内容
        registerForm.style.display = "none";
        loginForm.style.display = "block";
        hasSubmitted2 = false; // 重置提交标志
      });

      // 点击关闭按钮后默认显示登录界面并清空所有内容
      closeButton.addEventListener("click", () => {
        clearErrorsAndInputs(loginFields, loginErrors); // 清空登录表单内容
        clearErrorsAndInputs(registerFields, registerErrors); // 清空注册表单内容
        registerForm.style.display = "none";
        loginForm.style.display = "block"; // 默认显示登录界面
        hasSubmitted = false; // 重置登录提交标志
        hasSubmitted2 = false; // 重置注册提交标志
      });

      </script>

      <!--//js working-->
      <!-- cart-js -->
      <script src="/static/index/js/minicart.js"></script>
      <script>
         toys.render();

         toys.cart.on('toys_checkout', function (evt) {
         	var items, len, i;

         	if (this.subtotal() > 0) {
         		items = this.items();

         		for (i = 0, len = items.length; i < len; i++) {}
         	}
         });
      </script>
      <!-- //cart-js -->
      <!--slider flexisel -->
      {% block js %}
      {% endblock js %}
      <script src="/static/index/js/move-top.js"></script>
      <script src="/static/index/js/easing.js"></script>
      <script>
         jQuery(document).ready(function ($) {
         	$(".scroll").click(function (event) {
         		event.preventDefault();
         		$('html,body').animate({
         			scrollTop: $(this.hash).offset().top
         		}, 900);
         	});
         });
      </script>
      <!-- start-smoth-scrolling -->
      <!-- here stars scrolling icon -->
      <script>
         $(document).ready(function () {

         	var defaults = {
         		containerID: 'toTop', // fading element id
         		containerHoverID: 'toTopHover', // fading element hover id
         		scrollSpeed: 1200,
         		easingType: 'linear'
         	};
         	$().UItoTop({
         		easingType: 'easeOutQuart'
         	});

         });
      </script>
      <!-- //here ends scrolling icon -->
      <!--bootstrap working-->
      <script src="/static/index/js/bootstrap.min.js"></script>
      <!-- //bootstrap working-->
   </body>
</html>